"use strict";const whiteBasemap=L.tileLayer("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/w8AAwAB/3cwcakAAAAASUVORK5CYII="),map=L.map("map",{attributionControl:!1,center:[-7.444992423191618,109.47077209463006],zoom:10,maxZoom:13,minZoom:10,layers:[whiteBasemap]});var circleBgTransparent={color:"black",fillColor:"transparent",fillOpacity:0,weight:1},circleBgWhite={color:"black",fillColor:"white",fillOpacity:1,weight:1},circleBgBlack={color:"black",fillColor:"black",fillOpacity:1,weight:1},bangunanPembagiList=[],bangunanSadapList=[],boxPetakList=[],SkemaSidareja={init:function(){var t;(t=L.control({position:"topright"})).onAdd=function(t){var e=L.DomUtil.create("div","legend");return e.innerHTML='\n            <div>\n              <table id="table-legenda" style="width: 100%; border-collapse: collapse;">\n                <thead>\n                  <tr>\n                    <th colspan="2">KETERANGAN :</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  <tr>\n                    <td class="text-center"><img src="/images/icon-bangunan-sadap.png" style="height: 20px; margin-right: 5px;"></td>\n                    <td>Bangunan Pengambil/Sadap</td>\n                  </tr>\n                  <tr>\n                    <td class="text-center"><img src="/images/icon-bangunan-pembagi.png" style="height: 20px; margin-right: 5px;"></td>\n                    <td>Bangunan Pembagi</td>\n                  </tr>\n                  <tr>\n                    <td class="text-center"><span style="vertical-align: middle;border: 2px solid rgba(26,188,156);display: inline-block;width: 1rem;height: 1rem;border-radius: 2px; margin-right: 5px;"></span></td>\n                    <td><span style="vertical-align: middle;">Golongan A</span></td>\n                  </tr>\n                  <tr>\n                    <td class="text-center"><span style="vertical-align: middle;border: 2px solid #027DFC;display: inline-block;width: 1rem;height: 1rem;border-radius: 2px; margin-right: 5px;"></span></td>\n                    <td><span style="vertical-align: middle;">Golongan B</span></td>\n                  </tr>\n                  <tr>\n                    <td class="text-center"><span style="vertical-align: middle;border: 2px solid #F509F2;display: inline-block;width: 1rem;height: 1rem;border-radius: 2px; margin-right: 5px;"></span></td>\n                    <td><span style="vertical-align: middle;">Golongan C</span></td>\n                  </tr>\n                  <tr>\n                    <td class="text-center fw-bold">K</td>\n                    <td>Debit Kebutuhan</td>\n                  </tr>\n                  <tr>\n                    <td class="text-center text-primary fw-bold">A</td>\n                    <td>Debit Aktual</td>\n                  </tr>\n                  <tr>\n                    <td class="text-center text-warning fw-bold">R</td>\n                    <td>Debit Rekomendasi</td>\n                  </tr>\n                </tbody>\n              </table>\n            </div>\n          ',e},t.addTo(map),generateBangunanPembagi("BS. VI",[[-8.05,108.77],[-8.22,108.77],[-8.22,108.72],[-8.3,108.72],[-8.38,108.72]]),function(){const t=[-8.05,108.77],e=[t[0],108.87],a=[t[0],109.04],n=[t[0],109.22],o=[t[0],109.4],i=[t[0],109.58],r=[t[0],109.76],d=[t[0],109.88],c=[t[0],110.08];generateBoxPetak("19f7b89b-09ec-4538-a27d-f522792d6b54","Pt. Kd. 8-Ki",[c,[-8,c[1]]],"top"),generateBoxPetak("bf22c9b5-1310-45f2-8c55-b1c729660edf","Pt. Kd. 8-Kn",[c,[-8.1,c[1]]],"bottom"),generateBangunanSadap("BKd. 8","bottomright",[t,c],90),generateBoxPetak("bb284931-2b5a-48ad-87e5-75a048c42c48","Pt. Kd. 7-Kn",[d,[-8.1,d[1]]],"bottom"),generateBangunanSadap("BKd. 7","bottomright",[t,d],90),generateBoxPetak("37ae32d1-80ca-4197-8ac5-69b13653f261","Pt. Kd. 6-Ki",[r,[-8,r[1]]],"top"),generateBangunanSadap("BKd. 6","bottomcenter",[t,r],90),generateBoxPetak("87d948a4-46d7-4c2f-92b1-eae58b8e8d24","Pt. Kd. 5-Ki",[i,[-8,i[1]]],"top"),generateBangunanSadap("BKd. 5","bottomcenter",[t,i],90),generateBoxPetak("5b8b2241-d1df-42e1-9409-a444f42a329e","Pt. Kd. 4-Ki",[o,[-8,o[1]]],"top"),generateBangunanSadap("BKd. 4","bottomcenter",[t,o],90),generateBoxPetak("c4690341-532f-43a6-9dd0-9a9d90e4f996","Pt. Kd. 3-Ki",[n,[-8,n[1]]],"top"),generateBangunanSadap("BKd. 3","bottomcenter",[t,n],90),generateBoxPetak("d2ea57f2-ac28-4aea-9626-619e46804ea1","Pt. Kd. 2-Ki",[a,[-8,a[1]]],"top"),generateBoxPetak("2a91cbf6-acd3-40f0-9c14-00856b14aba6","Pt. Kd. 2-Kn",[a,[-8.1,a[1]]],"bottom"),generateBangunanSadap("BKd. 2","topleft",[t,a],90),generateBoxPetak("c5dc7b64-2019-4c6d-97c8-ccc4a54a130b","Pt. Kd. 1-Kn",[e,[-8.1,e[1]]],"bottom"),generateBangunanSadap("BKd. 1","topcenter",[t,e],90),generateBangunanPembagi("BS. V",[[-7.855,108.77],t]),generateTextSaluranSekunder("SS. KEDUNG DADAP",[-7.9,109.3],0)}(),function(){const t=[-7.86,108.77];generateBoxPetak("0d219996-918d-4549-9a4a-0a6820e9e40d","Pts. IV Ki",[t,[t[0],108.81]],"right"),generateBangunanPembagiDanSadap("BS. IV",[[-7.675,108.77],t])}(),function(){const t=[-7.675,108.77],e=[t[0],108.87],a=[t[0],109.038],n=[t[0],109.15],o=[t[0],109.33],i=[t[0],109.51];generateBoxPetak("9420e89d-7dac-4532-ae6c-2c780837e57b","Pts. Rm. 5-Ki",[i,[-7.65,i[1]]],"top"),generateBoxPetak("89c2cd98-caea-42d4-af0b-2ba7bd55c667","Pts. Rm. 5-Kn",[i,[-7.73,i[1]]],"bottom"),generateBangunanSadap("BRm. 5","bottomright",[t,i],90),generateBoxPetak("af93bac3-682a-4c93-a997-91979f0ae3a0","Pts. Rm. 4-Ki",[o,[-7.65,o[1]]],"top"),generateBangunanSadap("BRm. 4","bottomcenter",[t,o],90),generateBoxPetak("509a16fd-9b7c-475f-89a0-24386d38709f","Pts. Rm. 3-Ki",[n,[-7.65,n[1]]],"top"),generateBangunanSadap("BRm. 3","bottomcenter",[t,n],90),generateBoxPetak("7cfa3b50-14b2-4724-a582-fddfb27ed8bc","Pts. Rm. 2-Kn",[a,[-7.72,a[1]]],"bottom"),generateBangunanSadap("BRm. 2","bottomright",[t,a],90),generateBoxPetak("8c2c67ac-756f-4de2-b3c2-f0b9e21cd6e5","Pts. Rm. 1-Ki",[e,[-7.65,e[1]]],"top"),generateBoxPetak("1518f3d6-5f9e-4ae7-b734-8ece837bcdc1","Pts. Rm. 1-Kn",[e,[-7.72,e[1]]],"bottom"),generateBangunanSadap("BRm. 1","bottomright",[t,e],90),generateBangunanPembagi("BS. III",[[-7.325,108.77],t]),generateTextSaluranSekunder("SS. REJA MULYA",[-7.57,109.2],0)}(),function(){const t=[-7.5,108.77],e=[-7.5,108.93],a=[-7.5,109.1];generateBoxPetak("a26be22c-f1e0-4400-af78-82b3b93cb1bf","Pt. Ks. 2-Ki",[a,[-7.475,a[1]]],"top"),generateBangunanSadap("BKs. 2","bottomcenter",[t,a],90),generateBoxPetak("3ca505a2-0038-45a7-aa38-e2f43205d84d","Pt. Ks. 1-Ki",[e,[-7.475,e[1]]],"top"),generateBangunanSadap("BKs. 1","bottomcenter",[t,e],90),generateBangunanPembagi("BS. II",[[-7.325,108.77],t]),generateTextSaluranSekunder("SS. KARANG SARI",[-7.4,108.92],0)}(),generateBoxPetak("fca11354-774f-4924-8dc6-c88bcd5f2de6","Pts. 1 Ki",[[-7.325,108.77],[-7.325,108.81]],"right"),generateBangunanPembagiDanSadap("BS. I",[[-7.235,108.77],[-7.325,108.77]]),L.marker([-7.15,108.8],{icon:L.divIcon({className:"panah-aliran",html:'<img src="/images/panah-aliran3.png" style="width: 59px; height: 15px;transform: rotate(130deg);background-color: transparent;border-color:#fff;" />'})}).addTo(map),L.polyline([[-7.1,108.8],[-7.235,108.77]],{color:"black",weight:1}).addTo(map),L.circle([-7.1,108.8],380,circleBgTransparent).addTo(map),L.circle([-7.1,108.8],830,circleBgTransparent).addTo(map).bindTooltip('<div class="text-sumber-aliran">BENDUNG MANGANTI</div>',{permanent:!0,direction:"right",className:"transparent-tooltip",offset:[10,1]}).openTooltip()}};function updateOffsetBangunanPembagi(t,e){var a=[0,0];a=10===e?[-15,0]:11===e?[-25,0]:12===e?[-45,0]:13===e?[-75,0]:[-55,0];const n=t.getTooltip().getContent();t.unbindTooltip(),t.bindTooltip(n,{permanent:!0,direction:"left",className:"transparent-tooltip",offset:a}).openTooltip()}function setResponsiveSkema(){const t=map.getZoom();var e=t+10;document.querySelectorAll(".bs-title").forEach(t=>{t.style.fontSize=`${e}px`}),bangunanPembagiList.forEach(e=>{updateOffsetBangunanPembagi(e,t)})}function generateBangunanPembagi(t,e){L.polyline(e,{color:"black",weight:1}).addTo(map);const a=`<div class="bs-title">${t}</div>`;var n=L.circle(e[e.length-1],1e3,circleBgWhite).addTo(map);L.circle(e[e.length-1],380,circleBgBlack).addTo(map),n.bindTooltip(a,{permanent:!0,direction:"left",className:"transparent-tooltip",offset:[-15,0]}).openTooltip(),bangunanPembagiList.push(n)}function generateBangunanPembagiDanSadap(t,e){L.polyline(e,{color:"black",weight:1}).addTo(map);const a=`<div class="bs-title">${t}</div>`;var n=L.circle(e[1],250,circleBgWhite).addTo(map);n.bindTooltip(a,{permanent:!0,direction:"left",className:"transparent-tooltip",offset:[-15,0]}).openTooltip(),bangunanPembagiList.push(n)}function generateBangunanSadap(t,e,a,n){L.polyline(a,{color:"black",weight:1}).addTo(map);const o=`<div class="bangunan-sadap-title" style="transform: rotate(${n}deg);white-space: nowrap;">${t}</div>`;var i=L.circle(a[1],250,circleBgWhite).addTo(map),r=[0,0],d="center";"topcenter"==e?(d="top",r=[0,-10]):"topleft"==e?(d="top",r=[-10,-10]):"bottomcenter"==e?(d="bottom",r=[0,10]):"bottomright"==e&&(d="bottom",r=[8,10]),i.bindTooltip(o,{permanent:!0,direction:d,className:"transparent-tooltip",offset:r}).openTooltip(),bangunanSadapList.push(i)}function generateBoxPetak(t,e,a,n,o){const i=L.polyline(a,{color:"black",weight:1}).addTo(map),r=`\n    <div class="box-petak golongan-a">\n        <table id="petak-${t}">\n            <tr>\n                <th class="text-center" colspan="2">${e}</th>\n            </tr>\n            <tr>\n                <td class="luas-petak">\n                  A= <strong>-</strong>\n                </td>\n                <td>\n                  <span class="debit-kebutuhan text-dark">K= <strong>-</strong></span>\n                  </br>\n                  <span class="debit-aktual text-primary">A= <strong>-</strong></span>\n                  </br>\n                  <span class="debit-rekomendasi text-warning">R= <strong>-</strong></span>\n                </td>\n            </tr>\n        </table>\n    </div>\n  `,d=i.getLatLngs()[1];i.bindTooltip(r,{permanent:!0,direction:n,className:"transparent-tooltip",offset:[0,0]}).openTooltip(d),boxPetakList.push(i)}function generateTextSaluranSekunder(t,e,a){L.marker(e,{icon:L.divIcon({className:"text-saluran-sekunder",iconSize:[100,40],html:`<div style="transform: rotate(${a}deg);">${t}</div>`})}).addTo(map)}function getSchemaData(t){console.log(boxPetakList),getData(`/Schema/GetSchemaDataByDate/${t}`).then(t=>{let e=t.data;200==e.metaData.code&&$.each(e.response,function(t,e){null==e.luas?$(`#petak-${e.id}`).find(".luas-petak").html("A= <strong>-</strong>"):$(`#petak-${e.id}`).find(".luas-petak").html(`A= ${e.luas} Ha`),null==e.debit_kebutuhan?$(`#petak-${e.id}`).find(".debit-kebutuhan").html("K= <strong>-</strong>"):$(`#petak-${e.id}`).find(".debit-kebutuhan").html(`K= ${e.debit_kebutuhan} m3/dt`),null==e.debit_rekomendasi?$(`#petak-${e.id}`).find(".debit-rekomendasi").html("R= <strong>-</strong>"):$(`#petak-${e.id}`).find(".debit-rekomendasi").html(`R= ${e.debit_rekomendasi} m3/dt`)})}).catch(t=>{let e=t.response.data;e.success||console.log(e.message)})}jQuery(document).ready(function(){SkemaSidareja.init(),getSchemaData("2024-07-14")}),map.on("zoomend",setResponsiveSkema),setResponsiveSkema();