"use strict";var dataTableHulu,dataHulu={init:function(){$(".parsley-validation").parsley(),$("#search-hulu-table").keyup(function(){dataTableHulu.search($(this).val()).draw()}),$("#length-hulu-table").change(function(){dataTableHulu.page.len($(this).val()).draw()}),(dataTableHulu=$("#table-hulu").DataTable({processing:!0,serverSide:!0,dom:"tipr",order:[[2,"asc"]],ajax:{url:"/DebitBendung/GetDataDebitHulu",type:"POST",dataType:"JSON"},columns:[{data:null},{data:"tanggal",name:"Tanggal",render:function(e){return formatDate(e,"tanggal")}},{data:"nilai",name:"Nilai",render:function(e){return e?`<span class="ketersediaan-color fw-semibold text-center d-block">${parseFloat(e).toFixed(2)}</span>`:'<span class="text-center d-block">-</span>'}},{data:"satuan",name:"Satuan",className:"text-center"},{data:"update",name:"Update",render:function(e){return formatDate(e,"update")}},{className:"text-nowrap",render:function(e,t,a){return`<button type="button" class="btn btn-xs btn-success me-1 rounded-2 action-button" data-id="${a.id}" onclick="createEditDebit(this, event)"><i class="mdi mdi-square-edit-outline me-1"></i>Edit</button>\n                            <button type="button" class="btn btn-xs btn-danger rounded-2" data-id="${a.id}" onclick="deleteDebit(this, event)"><i class="mdi mdi-delete me-1"></i>Delete</button>`}}],columnDefs:[{targets:0,searchable:!1,orderable:!1,width:"9%",className:"text-center"},{targets:-1,searchable:!1,orderable:!1,width:"18%",className:"text-center"}],language:{paginate:{previous:"<i class='mdi mdi-chevron-left'>",next:"<i class='mdi mdi-chevron-right'>"}},drawCallback:function(){$(".dataTables_paginate > .pagination").addClass("pagination-rounded")}})).on("draw.dt",function(){var e=dataTableHulu.page.info();dataTableHulu.column(0,{search:"applied",order:"applied",page:"applied"}).nodes().each(function(t,a){t.innerHTML=a+1+e.start})})}};function formatDate(e,t){const a=new Date(e),n=a.getDate(),r=["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"][a.getMonth()],i=a.getFullYear(),l=String(a.getHours()).padStart(2,"0"),d=String(a.getMinutes()).padStart(2,"0");return"tanggal"===t?`${n} ${r} ${i}`:"update"===t?`${n} ${r} ${i} ${l}:${d}`:void 0}function getValueById(e){return document.getElementById(e).value}jQuery(document).ready(function(){dataHulu.init(),$("#input-hulu").on("submit",function(e){e.preventDefault();var t=$(this).find('button[type="submit"]'),a=t.text();t.prop("disabled",!0).html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Loading...'),$.ajax({url:"/DebitBendung/SaveHulu",type:"POST",data:$(this).serialize(),success:function(e){200==e.code?($("#input-hulu")[0].reset(),dataTableHulu.ajax.reload(null,!1)):alert("There was an error submitting the form.")},error:function(e,t,a){console.error("Submission failed:",a),alert("An error occurred while submitting the form.")},complete:function(){t.prop("disabled",!1).html(a)}})})}),window.createEditDebit=((e,t)=>{t.preventDefault();var a=$(e).html();beforeLoadingButton($(e));var n=$(e).data("id"),r=new FormData;r.append("Id",n),postData("/DebitBendung/CreateEditHulu",r).then(t=>{let n=t.data;$("#modalCreateEditDebit .modal-content").html(n),$("#modalCreateEditDebit").modal("show"),afterLoadingButton($(e),a)})}),window.updateHulu=((e,t)=>{t.preventDefault();var a=$(e).find("button[type=submit]");if($(e).parsley().validate(),$(e).parsley().isValid()){beforeLoadingButton(a);var n=new FormData;n.append("Id",getValueById("Id")),n.append("Nilai",getValueById("Nilai")),n.append("Satuan",getValueById("Satuan")),postData("/DebitBendung/UpdateHulu",n).then(e=>{let t=e.data;200==t.code?($("#modalCreateEditDebit").modal("hide"),dataTableHulu.ajax.reload(null,!1)):showMessage("error","Gagal!",t.message),afterLoadingButton(a)}).catch(e=>{console.log(e),afterLoadingButton(a)})}}),window.deleteDebit=((e,t)=>{t.preventDefault();var a=$(e).data("id");Swal.fire({title:"Hapus Debit",text:"Anda yakin untuk menghapus Debit tersebut ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal",showLoaderOnConfirm:!0,preConfirm:()=>deleteData("/DebitBendung/DeleteHulu/"+a).then(e=>{if(200!==e.status)throw new Error(e.statusText);return e}).catch(e=>{Swal.showValidationMessage(`Request failed: ${e}`)}),allowOutsideClick:()=>!Swal.isLoading()}).then(e=>{console.log(e),e.isConfirmed&&(200==e.value.data.code?dataTableHulu.ajax.reload(null,!1):showMessage("error","Failed",e.value.data.message))})});