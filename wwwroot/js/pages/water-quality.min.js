"use strict";var dataTablePosWaterQuality,dataTableWaterQuality,DataWaterQuality={init:function(){$(".parsley-validation").parsley(),$("#search-station-table").keyup(function(){dataTablePosWaterQuality.search($(this).val()).draw(),dataTableWaterQuality.search($(this).val()).draw()}),$("#length-station-table").change(function(){dataTablePosWaterQuality.page.len($(this).val()).draw(),dataTableWaterQuality.page.len($(this).val()).draw()}),(dataTablePosWaterQuality=$("#table-pos-water-quality").DataTable({processing:!0,serverSide:!0,dom:"tipr",order:[[1,"asc"]],ajax:{url:"/WaterQuality/GetdataTablePosWaterQuality",type:"POST",contentType:"application/json",dataType:"JSON",data:function(a){return JSON.stringify(a)}},columns:[{data:null},{data:"name",name:"name"},{data:"latitude",name:"latitude",render:function(a,t,e){return null==e?"-":`${e.latitude}, ${e.longitude}`}},{data:"lastValue",name:"lastValue"},{data:"lastStatus",name:"lastStatus"},{data:"lastUpdated",name:"lastUpdated"},{render:function(a,t,e){return`<a href="/WaterQuality/Detail/${e.id}" target="_blank" class="btn btn-xs btn-blue rounded-2 me-1" data-id="${e.id}"><i class="mdi mdi-eye"></i></a>\n                            <button onclick="createEdit(this, event)" data-id="${e.id}" class="btn btn-xs btn-success rounded-2 me-1"><i class="mdi mdi-square-edit-outline"></i></button>\n                            <button type="button" class="btn btn-xs btn-danger rounded-2" data-id="${e.id}" onclick="deletePos(this, event)"><i class="mdi mdi-delete"></i></button>`}}],columnDefs:[{targets:0,searchable:!1,orderable:!1,width:"9%",className:"text-center"},{targets:5,render:function(a){return null===a?"":moment(a).format("DD-MMM-YYYY")}},{targets:-1,searchable:!1,orderable:!1,width:"18%",className:"text-center"}],language:{paginate:{previous:"<i class='mdi mdi-chevron-left'>",next:"<i class='mdi mdi-chevron-right'>"}},drawCallback:function(){$(".dataTables_paginate > .pagination").addClass("pagination-rounded")}})).on("draw.dt",function(){var a=dataTablePosWaterQuality.page.info();dataTablePosWaterQuality.column(0,{search:"applied",order:"applied",page:"applied"}).nodes().each(function(t,e){t.innerHTML=e+1+a.start})}),function(){let a=$("#station-id").val();null!=a&&""!=a&&(dataTableWaterQuality=$("#table-water-quality").DataTable({processing:!0,serverSide:!0,dom:"tipr",order:[[1,"asc"]],ajax:{url:"/WaterQuality/GetDatatableWaterQuality?StationId="+a,type:"POST",contentType:"application/json",dataType:"JSON",data:function(a){return JSON.stringify(a)}},columns:[{data:null},{data:"qualityValue",name:"qualityValue"},{data:"qualityStatus",name:"qualityStatus"},{data:"createdDate",name:"createdDate"},{render:function(a,t,e){return`\n                <button onclick="createEditWq(this, event)" data-id="${e.id}" data-date="${e.createdDate}"  class="btn btn-xs btn-success rounded-2 me-1"><i class="mdi mdi-square-edit-outline"></i></button>\n                <button type="button" class="btn btn-xs btn-danger rounded-2" data-id="${e.id}" onclick="deleteWq(this, event)"><i class="mdi mdi-delete"></i></button>`}}],columnDefs:[{targets:0,searchable:!1,orderable:!1,width:"9%",className:"text-center"},{targets:3,render:function(a){return null===a?"":moment(a).format("DD-MMM-YYYY")}},{targets:-1,searchable:!1,orderable:!1,width:"18%",className:"text-center"}],language:{paginate:{previous:"<i class='mdi mdi-chevron-left'>",next:"<i class='mdi mdi-chevron-right'>"}},drawCallback:function(){$(".dataTables_paginate > .pagination").addClass("pagination-rounded")}})).on("draw.dt",function(){var a=dataTableWaterQuality.page.info();dataTableWaterQuality.column(0,{search:"applied",order:"applied",page:"applied"}).nodes().each(function(t,e){t.innerHTML=e+1+a.start})})}()}};function createEditWq(a,t){var e=$(a).html();beforeLoadingButton($(a));var n=$(a).data("id"),d=$(a).data("date"),i=new FormData;i.append("Id",n),""!==n||null==n?i.append("CreatedDate",d):i.append("CreatedDate",$("#CreatedDate").val()),postData(`/WaterQuality/CreateEditWq?StationId=${$("#station-id").val()}`,i).then(t=>{let n=t.data;console.log(n),$("#modalCreateEditWq .modal-content").html(n),$("#modalCreateEditWq").modal("show"),afterLoadingButton($(a),e)})}function createEdit(a,t){var e=$(a).html();beforeLoadingButton($(a));var n=$(a).data("id"),d=new FormData;d.append("Id",n),postData("/WaterQuality/CreateEdit",d).then(t=>{let n=t.data;console.log(n),$("#modalCreateEdit .modal-content").html(n),$("#modalCreateEdit").modal("show"),afterLoadingButton($(a),e)})}function deletePos(a,t){var e=$(a).data("id");Swal.fire({title:"Hapus Kualitas Air",text:"Anda yakin untuk menghapus Pos Kualitas Air tersebut ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal",showLoaderOnConfirm:!0,preConfirm:a=>deleteData("/WaterQuality/DeletePosWaterQuality/"+e).then(a=>{if(200!==a.status)throw new Error(a.statusText);return a}).catch(a=>{Swal.showValidationMessage(`Request failed: ${a}`)}),allowOutsideClick:()=>!Swal.isLoading()}).then(a=>{a.isConfirmed&&(200==a.value.data.code?($("#modalCreateEdit").modal("hide"),showMessage("success","Sukses!",a.value.data.message),dataTablePosWaterQuality.ajax.reload()):showMessage("error","Failed",a.value.data.message))})}jQuery(document).ready(function(){DataWaterQuality.init()}),window.savePosWaterQuality=((a,t)=>{t.preventDefault();var e=$(a).find("button[type=submit]");if($(a).parsley().validate(),$(a).parsley().isValid()){beforeLoadingButton(e);var n=new FormData;n.append("Id",getValueById("Id")),n.append("Name",getValueById("Name")),n.append("Latitude",getValueById("Latitude")),n.append("Longitude",getValueById("Longitude")),n.append("LastValue",getValueById("LastValue")),postData("/WaterQuality/SavePosWaterQuality",n).then(a=>{let t=a.data;200==t.code?($("#modalCreateEdit").modal("hide"),showMessage("success","Sukses!",t.message),dataTablePosWaterQuality.ajax.reload(),"updated"!=t.response&&(window.location.href="/WaterQuality/Detail/"+t.response.id),console.log(t)):showMessage("error","Gagal!",t.message),afterLoadingButton(e)}).catch(a=>{console.log(a),afterLoadingButton(e)})}}),window.saveWaterQuality=((a,t)=>{t.preventDefault();var e=$(a).find("button[type=submit]");if($(a).parsley().validate(),$(a).parsley().isValid()){beforeLoadingButton(e);var n=new FormData;n.append("Id",getValueById("Id")),n.append("StationId",getValueById("StationId")),n.append("QualityValue",getValueById("QualityValue")),n.append("CreatedDate",getValueById("CreatedDate")),postData("/WaterQuality/SaveWaterQuality",n).then(a=>{let t=a.data;200==t.code?($("#modalCreateEditWq").modal("hide"),showMessage("success","Sukses!",t.message),dataTableWaterQuality.ajax.reload()):showMessage("error","Gagal!",t.message),afterLoadingButton(e)}).catch(a=>{console.log(a),afterLoadingButton(e)})}}),window.deleteWq=((a,t)=>{t.preventDefault();var e=$(a).data("id");Swal.fire({title:"Hapus Kualitas Air",text:"Anda yakin untuk menghapus Kualitas Air tersebut ?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Ya, Hapus",cancelButtonText:"Batal",showLoaderOnConfirm:!0,preConfirm:a=>deleteData("/WaterQuality/DeleteWaterQuality/"+e).then(a=>{if(200!==a.status)throw new Error(a.statusText);return a}).catch(a=>{Swal.showValidationMessage(`Request failed: ${a}`)}),allowOutsideClick:()=>!Swal.isLoading()}).then(a=>{a.isConfirmed&&(200==a.value.data.code?($("#modalCreateEditWq").modal("hide"),showMessage("success","Sukses!",a.value.data.message),dataTableWaterQuality.ajax.reload()):showMessage("error","Failed",a.value.data.message))})});